#!/bin/sh -e

PKG="byobu"

if [ -x "/usr/bin/screen.real" ]; then
	# Byobu used to divert the real /usr/bin/screen, but we don't
	# do this anymore; clean up old diversion if upgrading
	if ls -alF /usr/bin/screen 2>/dev/null | grep -qs "^l.*/usr/bin/screen -> byobu"; then
		rm -f /usr/bin/screen
	fi
        dpkg-divert --package "$PKG" --rename --remove /usr/bin/screen
fi

# Notify users that they should reload their profile
DIR="/var/run/screen"
for d in $(ls "$DIR"); do
	touch "$DIR/$d/$PKG.reload-required"
	u=$(echo "$d" | sed "s:^S-::")
	chown $u:$u "$DIR/$d/$PKG.reload-required"
done

#DEBHELPER#
